# Local dev composition for Nomologi.
# Designed to work with podman (e.g., `podman-compose -f infra/docker-compose.dev.yml up`).

services:
  mongo:
    image: docker.io/library/mongo:7
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: nomologi
      MONGO_INITDB_ROOT_PASSWORD: nomologi

  redis:
    image: docker.io/library/redis:7
    ports:
      - "6379:6379"

  node-api:
    build: ../backend/node-api
    depends_on:
      - mongo
      - redis
    environment:
      MONGO_URL: mongodb://nomologi:nomologi@mongo:27017
      REDIS_URL: redis://redis:6379

  frontend:
    build: ../frontend
    depends_on:
      - node-api
    ports:
      - "3000:3000"
    environment:
      API_BASE_URL: http://node-api:3000
